Ethan Samuels-Ellingson  
12/6/2020  

# Description: #
Full stack application for a pizza restaurant.  
    1. RESTful API  
    2. web front end  
    3. CLI for admin

This application integrates with two services via http requests   
1) mailGun https://www.mailgun.com/   
to send confirmation emails to customers after placing an order  
2) Stripe https://stripe.com/  
to create payment intents


## SET UP INSTRUCTIONS:  ##
---
1) generate key.cert and key.pem in /https folder  
2) add mailGun API key and domain name to /lib/config.js  
    - a free account can use a mailgun-provided sandboxed domain   
    - you can only send emails to authorized recipients from a sandboxed domain and must authorize yourself as a recipient

3) add Stripe test token to the /public/app.js file.  
    - in a real app this would be generated by Stripe's client-side library  
    - this tests integration with Stripe and does not create a real charge
4) run `node index.js` and navigate to localHost:3000 in a web browser or interact with the CLI

# CLI Documentation:  #
run 'man' or 'help' to view man page  

# API Documentation:   #
## /api/Users ##
---
### POST ###
    used to create a new user  
    required: newUserObject (body)
    newUserObject = {
        email: string,
        password: string,
        firstName: string,
        lastName: string,
        streetAddress: string
    }
### GET ###
    get a user object
    required: token (header), email (query parameter) 
### PUT ###
    update user attributes
    required: updateObject, token(header)
    updateObject = {
        email: string (required),
        firstName: string (optional),
        lastName: string (optional),
        streetAddress: string (optional),
        password: string (optional)
    }
    must supply one or more attribute to update, email, and token
### DELETE ###
    delete a user
    required: token (header), email (query parameter)
    token must be valid for the user to be deleted

## /api/tokens ##
---
### POST ###
    create a token to perform authenticated requests
    required: email and password in body
    successful response: 
    {
        "email":"a@example.com",
        "tokenId":"8kbavlx723y3xgnh5cv9",
        "expires":1609827989178
    }
### GET ###
    get a token
    required: token (query string param)
    ex: .../tokens GET?token=TOKEN_ID_TO_GET
    tokens are valid for one hour and can be extended through /api/tokens PUT
### PUT ###
    tokens can be extended to remain continue session
    required: extendRequestBody
    extendRequestBody = {
        tokenId: TOKENID_TO_EXTEND,
        extend: true
    }
    tokens can only be extended if they have not already expired. If a token has expired create a new token with tokens POST
### DELETE ###
    delete a token to log the client out
    required: tokenId (query parameter), email(body)
    Token provided in header must belong to user supplied in body

## /api/orders ##
---
### POST ###
    create an order
    required: token(header), email (body)
    successful response: 
    {
        "orderId":"zdi06qnukotlwsvvl5w8",
        "email":"a@example.com",
        "placed":false,
        "items":{},
        "totalPrice":0
    }
### GET ###
    get an order
    required: token(header), orderId(query parameter)
### PUT ### 
    updates an order
    add / remove items or checkout
    required: token (header), updateOrderObject (body)
    ex:
    updateOrderObject={ 
        orderId: string,
        "item0" : 3,
        "item1": 5,
        "item2": 0,
        stripeToken: string
    }
    Multiple fields can be updated in a single request.
    Pass stripeToken to place order.
### DELETE ###
    deletes an order
    required token(header), orderId (query string param)
    Orders can only be deleted if they have not been placed.
    Token passed in header must be valid for the owner of the order to be deleted.

## /api/menu ##
---
### GET ###
    returns the menu
    required: token (header), email (body) 
    response:
    {
        item0: { name: 'Pineapple pizza', price: 14 },
        item1: { name: 'Pineapple pizza w/ extra pineapple', price: 16 },
        item2: { name: 'Pineapple pizza w/ anchovies', price: 17 }
    }
